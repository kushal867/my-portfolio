<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Quiz Game</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container py-5">
  <h1 class="mb-4 text-center">Django Quiz</h1>

  <form id="quizForm" method="POST" action="{% url 'save-score' %}">
    {% csrf_token %}
    <div class="mb-3">
      <label for="username" class="form-label">Enter Your Name:</label>
      <input type="text" name="username" class="form-control" required>
    </div>

    {% for q in questions %}
      <div class="card mb-3 p-3">
        <p><strong>Q{{ forloop.counter }}. {{ q.question_text }}</strong></p>
        <div>
          <input type="radio" name="q{{ q.id }}" value="A"> {{ q.option_a }} <br>
          <input type="radio" name="q{{ q.id }}" value="B"> {{ q.option_b }} <br>
          <input type="radio" name="q{{ q.id }}" value="C"> {{ q.option_c }} <br>
          <input type="radio" name="q{{ q.id }}" value="D"> {{ q.option_d }} <br>
          <input type="hidden" name="correct{{ q.id }}" value="{{ q.correct_answer }}">
        </div>
      </div>
    {% endfor %}

    <input type="hidden" id="scoreInput" name="score" value="0">
    <button type="submit" class="btn btn-success">Submit Quiz</button>
  </form>
</div>

<script>
document.getElementById("quizForm").addEventListener("submit", function(e) {
  let score = 0;
  const form = e.target;
  {% for q in questions %}
    let selected = form.querySelector('input[name="q{{ q.id }}"]:checked');
    if (selected && selected.value === "{{ q.correct_answer }}") {
      score++;
    }
  {% endfor %}
  document.getElementById("scoreInput").value = score;
});
</script>
</body>
</html>
